<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>PVP TIERS</title>
    <meta name="description" content="Official Player Rankings and Kit Tiers.">
    <meta property="og:title" content="PVP TIERS">
    <meta property="og:description" content="Global Leaderboards and Official Tier Rankings.">
    <meta property="og:image" content="backgroundsword.png">
    <meta name="theme-color" content="#a855f7">
    <link rel="icon" type="image/png" href="backgroundsword.png">

    <style>
        @font-face { font-family: 'MultiCraftFont'; src: url('MultiCraftFont.ttf'); }
        :root {
            --bg: #030406; --purple: #a855f7; --border: rgba(168, 85, 247, 0.3);
            --gold: #ffd700; --t1: #ff4d4d;
        }

        body { background: var(--bg); color: #fff; font-family: 'Courier New', monospace; margin: 0; overflow-x: hidden; }

        /* Spinning Glowing Background Canvas */
        #bgCanvas { position: fixed; top: 0; left: 0; z-index: -1; pointer-events: none; }

        /* Navigation */
        nav { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 20px 40px; background: rgba(0,0,0,0.8); border-bottom: 1px solid var(--border);
            backdrop-filter: blur(10px); sticky; top: 0; z-index: 100;
        }
        .nav-link { color: #5a6474; cursor: pointer; font-weight: bold; text-transform: uppercase; transition: 0.3s; }
        .nav-link:hover, .nav-link.active { color: #fff; text-shadow: 0 0 10px var(--purple); }

        /* Buttons with Animations */
        .kit-btn {
            background: transparent; border: 1px solid var(--border); color: #fff;
            padding: 12px 24px; border-radius: 4px; cursor: pointer; font-weight: bold;
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .kit-btn:hover { 
            background: var(--purple); color: #000; 
            transform: scale(1.1) rotate(-1deg); box-shadow: 0 0 20px var(--purple);
        }
        .kit-btn.active { background: var(--purple); color: #000; box-shadow: 0 0 30px var(--purple); }

        /* Layout */
        .header { text-align: center; padding: 60px 0; animation: slideDown 1s ease; }
        @keyframes slideDown { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .tier-scroll { display: flex; gap: 20px; overflow-x: auto; padding: 20px; scrollbar-width: none; }
        .tier-col { 
            flex: 0 0 300px; border: 1px solid var(--border); background: rgba(255,255,255,0.01);
            animation: fadeIn 0.5s ease forwards; opacity: 0;
        }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }

        .p-row { display: flex; justify-content: space-between; padding: 15px 20px; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; }
        .p-row:hover { background: rgba(168, 85, 247, 0.1); padding-left: 30px; transition: 0.3s; }

        /* Modal Pop-up */
        .modal { display:none; position:fixed; inset:0; z-index:2000; background:rgba(0,0,0,0.9); align-items:center; justify-content:center; }
        .modal-box { 
            background: #0a0a0c; border: 1px solid var(--purple); padding: 40px; width: 400px; 
            animation: pop 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes pop { from { transform: scale(0); } to { transform: scale(1); } }
    </style>
</head>
<body>

<canvas id="bgCanvas"></canvas>

<nav>
    <div style="display:flex; gap:30px;">
        <span class="nav-link active" onclick="showTab('rankings')">Rankings</span>
        <span class="nav-link" onclick="showTab('info')">Info</span>
        <span class="nav-link" onclick="showTab('hof')">Hall of Fame</span>
    </div>
    <input type="text" id="mainSearch" style="background:#111; border:1px solid var(--border); color:#fff; padding:8px 15px;" placeholder="SEARCH PLAYER..." oninput="doSearch()">
</nav>

<div class="header">
    <h1 style="font-family:'MultiCraftFont'; font-size: 4rem; letter-spacing: 10px; margin: 0;">PVP TIERS</h1>
    <p style="opacity: 0.5; letter-spacing: 2px;">MULTITIERS.NET</p>
</div>

<div class="container" style="max-width: 1400px; margin: auto; padding: 0 20px;">
    <div id="rankings-tab">
        <div id="kitBar" style="display:flex; justify-content:center; gap:10px; margin-bottom:50px; flex-wrap:wrap;"></div>
        <div id="tierDisplay"></div>
    </div>
</div>

<div id="pModal" class="modal">
    <div class="modal-box">
        <h2 id="modalName" style="color:var(--purple); text-transform:uppercase;"></h2>
        <div id="modalData" style="margin-top:20px; line-height:1.6;"></div>
        <button onclick="closeP()" style="margin-top:30px; width:100%; padding:10px; background:var(--purple); border:none; cursor:pointer; font-weight:bold;">CLOSE</button>
    </div>
</div>

<script>
let DATA = {}; let OVERALL = {};

// Background Animation Engine
const canvas = document.getElementById('bgCanvas');
const ctx = canvas.getContext('2d');
let particles = [];

function initParticles() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    particles = [];
    for(let i=0; i<40; i++) {
        particles.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            size: Math.random() * 3 + 1,
            speed: Math.random() * 1 + 0.5,
            rotation: Math.random() * Math.PI * 2,
            spin: Math.random() * 0.05
        });
    }
}

function draw() {
    ctx.clearRect(0,0,canvas.width, canvas.height);
    ctx.fillStyle = "rgba(168, 85, 247, 0.4)";
    particles.forEach(p => {
        p.y -= p.speed;
        p.rotation += p.spin;
        if(p.y < -20) p.y = canvas.height + 20;
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rotation);
        ctx.shadowBlur = 15;
        ctx.shadowColor = "#a855f7";
        ctx.fillRect(-p.size, -p.size, p.size*2, p.size*2);
        ctx.restore();
    });
    requestAnimationFrame(draw);
}

async function init() {
    const r = await fetch(`rankings.json?v=${Date.now()}`).then(res => res.json());
    DATA = r;
    buildOverall();
    genButtons();
    render("Overall");
}

function buildOverall() {
    const pts = { "HT1":10, "LT1":9, "HT2":8, "LT2":7, "HT3":6, "LT3":5 };
    for(let k in DATA) {
        if(k === "Players" || k === "Overall") continue;
        for(let t in DATA[k]) {
            DATA[k][t].forEach(n => { OVERALL[n] = (OVERALL[n] || 0) + (pts[t] || 0); });
        }
    }
}

function genButtons() {
    const bar = document.getElementById('kitBar');
    ["Overall", ...Object.keys(DATA).filter(k => k!=="Players" && k!=="Overall")].forEach(k => {
        const b = document.createElement('button');
        b.className = 'kit-btn'; b.innerText = k;
        b.onclick = () => { document.querySelectorAll('.kit-btn').forEach(x=>x.classList.remove('active')); b.classList.add('active'); render(k); };
        if(k === "Overall") b.classList.add('active');
        bar.appendChild(b);
    });
}

function render(kit) {
    const out = document.getElementById('tierDisplay');
    if(kit === "Overall") {
        let sorted = Object.entries(OVERALL).sort((a,b)=>b[1]-a[1]);
        out.innerHTML = sorted.map(([n,p], i) => `<div class="p-row" onclick="openP('${n}')"><span>#${i+1} ${n}</span><span>${p} PTS</span></div>`).join('');
    } else {
        let html = `<div class="tier-scroll">`;
        ["HT1","LT1","HT2","LT2","HT3","LT3"].forEach(t => {
            html += `<div class="tier-col"><div style="padding:15px; text-align:center; font-weight:bold; border-bottom:1px solid var(--border);">${t}</div>`;
            (DATA[kit][t] || []).forEach(n => { html += `<div class="p-row" onclick="openP('${n}')">${n}</div>`; });
            html += `</div>`;
        });
        out.innerHTML = html + `</div>`;
    }
}

function openP(n) {
    const p = DATA.Players[n] || {};
    document.getElementById('modalName').innerText = n;
    document.getElementById('modalData').innerHTML = `DISCORD: ${p.discord || 'N/A'}<br>REGION: ${p.region || '??'}<br>POINTS: ${OVERALL[n] || 0}`;
    document.getElementById('pModal').style.display = 'flex';
}

function closeP() { document.getElementById('pModal').style.display = 'none'; }
window.addEventListener('resize', initParticles);
initParticles(); draw(); init();
</script>
</body>
</html>
